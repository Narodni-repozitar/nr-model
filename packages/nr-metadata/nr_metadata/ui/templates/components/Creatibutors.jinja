{#def metadata, search_link #}
{% set metadata_dict = metadata | to_dict %}
{% set creators = metadata_dict['creators'] if metadata_dict['creators']  else [] %}
{% set contributors = metadata_dict['contributors'] if metadata_dict['contributors']  else [] %}
{% set all_creatibutors = creators + contributors %}

{% if all_creatibutors %}
    {% set name_types = all_creatibutors | map(attribute='nameType') | list %}
    {% set unique_name_types = name_types | unique | list %}

    {% if unique_name_types | length == 1 %}
        {% if 'Personal' in unique_name_types %}
            {% set title = _("People") %}
        {% else %}
            {% set title = _("Organizations") %}
        {% endif %}
    {% else %}
        {% set title = _("People/Organizations") %}
    {% endif %}

    <dt>{{ title }}</dt>
    <dd>
        <div class="ui double separated">
            <div role="list" class="ui horizontal separated creatibutors list">
                {% for creatibutor in creators %}
                    <Creatibutor creatibutor={creatibutor} search_link={search_link} searchFacet="syntheticFields_people"></Creatibutor>
                {% endfor %}
            </div>
            {% if contributors %}
                <div class="double separator"></div>
                <div role="list" class="ui horizontal separated creatibutors list">
                    {% for fullName, matches in contributors | groupby('fullName') %}
                        {% set roles = matches | map(attribute='role') | select('defined') | list %}
                        <Creatibutor creatibutor={matches[0]} search_link={search_link} searchFacet="syntheticFields_people" roles={roles}></Creatibutor>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </dd>
{% endif %}
